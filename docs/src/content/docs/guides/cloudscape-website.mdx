---
title: CloudScape Website
description: Reference documentation for a CloudScape Website
---
import { FileTree, Steps } from '@astrojs/starlight/components';
import RunGenerator from '../../../components/run-generator.astro';
import GeneratorParameters from '../../../components/generator-parameters.astro';
import NxCommands from '../../../components/nx-commands.astro';
import schema from '../../../../../packages/nx-plugin/src/cloudscape-website/app/schema.json';

This generator creates a new [React](https://react.dev/) website with [CloudScape](http://cloudscape.design/) configured, along with the AWS CDK infrastructure to deploy your website to the cloud as a static website hosted in [S3](https://aws.amazon.com/s3/), served by [CloudFront](https://aws.amazon.com/cloudfront/) and protected by [WAF](https://aws.amazon.com/waf/).

The generated application uses [Vite](https://vite.dev/) as the build tool and bundler. It uses [TanStack Router](https://tanstack.com/router/v1) for type-safe routing.

:::note
While this generator sets you up with CloudScape, it is ultimately a React project generator, and you can modify your code to move to an alternative design system or component library should you wish.
:::

## Usage

### Generate a CloudScape Website

You can generate a new CloudScape Website in two ways:

<RunGenerator generator="ts#cloudscape-website" />

### Options

<GeneratorParameters schema={schema} />

## Generator Output

The generator will create the following project structure in the `<directory>/<name>` directory:

<FileTree>
  - index.html HTML entry point
  - public Static assets
  - src
    - main.tsx Application entry point with React setup
    - config.ts Application configuration (eg. logo)
    - components
      - AppLayout Components for the overall CloudScape layout and navigation bar
    - hooks
      - useAppLayout.tsx Hook for adjusting the AppLayout from nested components
    - routes
      - welcome
        - index.tsx Example route (or page) for @tanstack/react-router
    - styles.css Global styles
  - vite.config.ts Vite and Vitest configuration
  - tsconfig.json Base TypeScript configuration for source and tests
  - tsconfig.app.json TypeScript configuration for source code
  - tsconfig.spec.json TypeScript configuration for tests
</FileTree>

The generator will also create CDK infrastructure code for deploying your website in the `packages/common/constructs` directory:

<FileTree>
  - src
    - app
      - static-websites
        - \<name>.ts Infrastructure specific to your website
    - core
      - static-website.ts Generic StaticWebsite construct
</FileTree>

## Implementing your CloudScape Website

The [React documentation](https://react.dev/learn) is a good place to start to learn the basics of building with React. You can refer to the [CloudScape documentation](https://cloudscape.design/components/) for details about the available components and how to use them.

### Routes

#### Creating a Route/Page

Your CloudScape website comes with [TanStack Router](https://tanstack.com/router/v1) configured. This makes it easy to add new routes:

<Steps>
  1. [Run the Local Development Server](#local-development-server)
  2. Create a new `<page-name>.tsx` file in `src/routes`, with its position in the file tree representing the path
  3. Notice a `Route` and `RouteComponent` are automatically generated for you. You can start building your page here!
</Steps>

#### Navigating Between Pages

You can use the `Link` component or `useNavigate` hook to navigate between pages:

```tsx {1, 4, 8-9, 14}
import { Link, useNavigate } from '@tanstack/react-router';

export const MyComponent = () => {
  const navigate = useNavigate();

  const submit = async () => {
    const id = await ...
    // Use `navigate` for redirecting after some asynchronous action
    navigate({ to: '/products/$id', { params: { id }} });
  };

  return (
    <>
      <Link to="/products">Cancel</Link>
      <Button onClick={submit}>Submit</Button>
    </>
  )
};
```

For more details, check out the [TanStack Router](https://tanstack.com/router/latest/docs/framework/react/overview) documentation.

## Runtime Configuration

Configuration from your AWS CDK infrastructure is provided to your website via Runtime Configuration. This allows your website to access details such as API URLs which are not known until your application is deployed.

### Infrastructure

The `RuntimeConfig` CDK construct can be used to add and retrieve configuration in your CDK infrastructure. The CDK constructs generated by `@aws/nx-plugin` (such as [tRPC APIs](/nx-plugin-for-aws/guides/trpc) and [FastAPIs](/nx-plugin-for-aws/guides/fastapi)) will automatically add appropriate values to the `RuntimeConfig`.

Your website CDK construct will deploy the runtime configuration as a `runtime-config.json` file to the root of your S3 bucket.

```ts title="packages/infra/src/stacks/application-stack.ts" {9-10,12-13}
import { Stack } from 'aws-cdk-lib';
import { Construct } from 'constructs';
import { MyWebsite } from ':my-scope/common-constructs';

export class ApplicationStack extends Stack {
  constructor(scope: Construct, id: string) {
    super(scope, id);

    // Automatically adds values to the RuntimeConfig
    new MyApi(this, 'MyApi');

    // Automatically deploys the runtime config to runtime-config.json
    new MyWebsite(this, 'MyWebsite');
  }
}
```

:::warning
You must ensure that you declare your website _after_ any constructs which add to the `RuntimeConfig`, otherwise they will be missing in your `runtime-config.json` file.
:::

### Website Code

In your website, you can use the `useRuntimeConfig` hook to retrieve values from the runtime configuration:

```tsx {1,4}
import { useRuntimeConfig } from '../hooks/useRuntimeConfig';

const MyComponent = () => {
  const runtimeConfig = useRuntimeConfig();

  // Access values in the runtime config here
  const apiUrl = runtimeConfig.httpApis.MyApi;
};
```

### Local Runtime Config

When running the [local development server](#local-development-server), you will need a `runtime-config.json` file in your `public` directory in order for your local website to know the backend URLs, identity configuration, etc.

Your website project is configured with a `load:runtime-config` target which you can use to pull down the `runtime-config.json` file from a deployed application:

<NxCommands commands={['run <my-website>:"load:runtime-config"']} />

:::warning
If you change the name of your stack in your infrastructure project's `src/main.ts`, you will need to update the `load:runtime-config` target in your website's `project.json` file with the name of the stack to load runtime configuration from.
:::

## Local Development Server

Before running your local development server, make sure that you have deployed your infrastructure and have [loaded local runtime configuration](#local-runtime-config).

You can then run the `serve` target:

<NxCommands commands={['run <my-website>:serve']} />

## Building

You can build your website using the `build` target. This use Vite to create a production bundle in the root `dist/packages/<my-website>/bundle` directory, as well as type-checking, compiling and linting your website.

<NxCommands commands={['run <my-website>:build']} />

## Testing

Testing your website is much like writing tests in a standard TypeScript project, so please refer to the [TypeScript project guide](/nx-plugin-for-aws/guides/typescript-project#testing) for more details.

For React specific testing, React Testing Library is already installed and available for you to use to write tests. For more details on its usage, please refer to the [React Testing Library documentation](https://testing-library.com/docs/react-testing-library/example-intro).

You can run your tests using the `test` target:

<NxCommands commands={['run <my-website>:test']} />

## Deploying Your Website

To deploy your website, we recommend using the [TypeScript Infrastructure Generator](/nx-plugin-for-aws/guides/typescript-infrastructure) to create a CDK application.

You can use the CDK construct generated for you in `packages/common/constructs` to deploy your website.

```ts title="packages/infra/src/stacks/application-stack.ts" {3, 9}
import { Stack } from 'aws-cdk-lib';
import { Construct } from 'constructs';
import { MyWebsite } from ':my-scope/common-constructs';

export class ApplicationStack extends Stack {
  constructor(scope: Construct, id: string) {
    super(scope, id);

    new MyWebsite(this, 'MyWebsite');
  }
}
```

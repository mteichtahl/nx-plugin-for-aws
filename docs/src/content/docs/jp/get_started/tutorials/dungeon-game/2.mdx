---
title: "AIãƒ€ãƒ³ã‚¸ãƒ§ãƒ³ã‚²ãƒ¼ãƒ "
description: "@aws/nx-pluginã‚’ä½¿ç”¨ã—ã¦AIãƒ‘ãƒ¯ãƒ¼ãƒ‰ã®ãƒ€ãƒ³ã‚¸ãƒ§ãƒ³å†’é™ºã‚²ãƒ¼ãƒ ã‚’æ§‹ç¯‰ã™ã‚‹æ–¹æ³•ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã€‚"
---



import { Aside, Code, FileTree, Steps, Tabs, TabItem } from '@astrojs/starlight/components';
import { Image } from 'astro:assets';
import Link from '@components/link.astro';
import Drawer from '@components/drawer.astro';
import RunGenerator from '@components/run-generator.astro';
import NxCommands from '@components/nx-commands.astro';
import InstallCommand from '@components/install-command.astro';
import E2EDiff from '@components/e2e-diff.astro';
import E2ECode from '@components/e2e-code.astro';

import dungeonAdventureArchitecturePng from '@assets/dungeon-game-architecture.png'
import dungeonAdventureErPng from '@assets/dungeon-adventure-er.png'
import baselineWebsitePng from '@assets/baseline-website.png'
import baselineGamePng from '@assets/baseline-game.png'
import nxGraphPng from '@assets/nx-graph.png'
import gameSelectPng from '@assets/game-select.png'
import gameConversationPng from '@assets/game-conversation.png'

## ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«2: ã‚²ãƒ¼ãƒ APIã®å®Ÿè£…

ã¾ãšã‚²ãƒ¼ãƒ APIã®å®Ÿè£…ã‹ã‚‰å§‹ã‚ã¾ã™ã€‚åˆè¨ˆ4ã¤ã®APIã‚’ä½œæˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™:

1. `createGame` - æ–°ã—ã„ã‚²ãƒ¼ãƒ ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œæˆ
2. `queryGames` - ä¿å­˜æ¸ˆã¿ã‚²ãƒ¼ãƒ ã®ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ä»˜ããƒªã‚¹ãƒˆã‚’è¿”å´
3. `saveAction` - æŒ‡å®šã—ãŸã‚²ãƒ¼ãƒ ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä¿å­˜
4. `queryActions` - ã‚²ãƒ¼ãƒ ã«é–¢é€£ã™ã‚‹å…¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ä»˜ããƒªã‚¹ãƒˆã‚’è¿”å´

### APIã‚¹ã‚­ãƒ¼ãƒ

APIã®å…¥åŠ›ã¨å‡ºåŠ›ã‚’å®šç¾©ã™ã‚‹ãŸã‚ã€`packages/game-api/schema/src`ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†…ã§[Zod](https://zod.dev/)ã‚’ä½¿ç”¨ã—ã¦ã‚¹ã‚­ãƒ¼ãƒã‚’ä½œæˆã—ã¾ã™:

<Tabs>
  <TabItem label="types/action.ts">
<E2ECode lang="typescript" path="dungeon-adventure/2/schema/types/action.ts.template" />
  </TabItem>
  <TabItem label="types/common.ts">
<E2ECode lang="typescript" path="dungeon-adventure/2/schema/types/common.ts.template" />
  </TabItem>
  <TabItem label="types/game.ts">
<E2ECode lang="typescript" path="dungeon-adventure/2/schema/types/game.ts.template" />
  </TabItem>
  <TabItem label="index.ts">
<E2EDiff lang="typescript" before="dungeon-adventure/2/schema/index.ts.old.template" after="dungeon-adventure/2/schema/index.ts.template" />
  </TabItem>
</Tabs>

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ä½¿ç”¨ã—ãªã„ãŸã‚ã€`./procedures/echo.ts`ãƒ•ã‚¡ã‚¤ãƒ«ã¯å‰Šé™¤ã§ãã¾ã™ã€‚

<Aside type="tip">
ä¸Šè¨˜ã®ã‚ˆã†ã«ã€Zodã§å®šç¾©ã™ã‚‹å„ã‚¹ã‚­ãƒ¼ãƒã«ã¤ã„ã¦ã€`z.TypeOf`æ§‹æ–‡ã‚’ä½¿ç”¨ã—ã¦ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚‚ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€é‡è¤‡ä½œæ¥­ãªã—ã§Zodå®šç¾©ã‚’TypeScriptã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã«å¤‰æ›ã§ãã¾ã™ï¼
</Aside>

### ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ãƒ¢ãƒ‡ãƒªãƒ³ã‚°

ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ERå›³ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™:

<Image class="centered-image white-bg" src={dungeonAdventureErPng} alt="dungeon-adventure-er.png" width="400" height="300" />

DynamoDBã§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’å®Ÿè£…ã™ã‚‹ãŸã‚ã€[ElectroDB](https://electrodb.dev/en/core-concepts/introduction/) DynamoDBã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã—ã¦ç°¡ç´ åŒ–ã—ã¾ã™ã€‚ã¾ãšæ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦`electrodb`ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™:

<InstallCommand pkg="electrodb @aws-sdk/client-dynamodb" />

<Aside>
ã™ã¹ã¦ã®ä¾å­˜é–¢ä¿‚ã¯ãƒ«ãƒ¼ãƒˆ`package.json`ã«è¿½åŠ ã•ã‚Œã¾ã™ã€‚`@aws/nx-plugin`ã¯[å˜ä¸€ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãƒãƒªã‚·ãƒ¼](https://nx.dev/concepts/decisions/dependency-management#single-version-policy)åŸå‰‡ã«å¾“ã£ã¦ã„ã¾ã™ã€‚è©³ç´°ã¯<Link path="guides/typescript-project#dependencies">ts#projectã‚¬ã‚¤ãƒ‰</Link>ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚
</Aside>

ä¸Šè¨˜ã®ERå›³ã«å¾“ã£ã¦ElectroDBã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’å®šç¾©ã™ã‚‹ãŸã‚ã€`packages/game-api/backend/src/entities`ãƒ•ã‚©ãƒ«ãƒ€å†…ã«ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™:

<Tabs>
  <TabItem label="action.ts">
<E2ECode lang="typescript" path="dungeon-adventure/2/entities/action.ts.template" />
  </TabItem>
  <TabItem label="game.ts">
<E2ECode lang="typescript" path="dungeon-adventure/2/entities/game.ts.template" />
  </TabItem>
</Tabs>

ElectroDBã¯éå¸¸ã«å¼·åŠ›ã§ã€å‹å®šç¾©ã ã‘ã§ãªãã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ãªã©ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚‚è¨­å®šã§ãã¾ã™ã€‚ã•ã‚‰ã«ElectroDBã¯DynamoDBä½¿ç”¨æ™‚ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã§ã‚ã‚‹[ã‚·ãƒ³ã‚°ãƒ«ãƒ†ãƒ¼ãƒ–ãƒ«è¨­è¨ˆ](https://electrodb.dev/en/core-concepts/single-table-relationships/)ã‚’æ¡ç”¨ã—ã¦ã„ã¾ã™ã€‚

<Aside>
ElectroDBã¯[ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³](https://electrodb.dev/en/modeling/collections/)ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ãŒã€ã“ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã§ã¯ç°¡ç•¥åŒ–ã®ãŸã‚ä½¿ç”¨ã—ã¾ã›ã‚“ã€‚
</Aside>

### tRPCã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã¸ã®DynamoDBã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆè¿½åŠ 

å„ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ã§DynamoDBã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ãŸã‚ã€ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆçµŒç”±ã§æ¸¡ã›ã‚‹ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®å˜ä¸€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œæˆã—ã¾ã™ã€‚ã“ã‚Œã‚’è¡Œã†ãŸã‚ã€`packages/game-api/backend/src`å†…ã§ä»¥ä¸‹ã®å¤‰æ›´ã‚’åŠ ãˆã¾ã™:

<Tabs>
  <TabItem label="middleware/dynamodb.ts">
<E2ECode lang="typescript" path="dungeon-adventure/2/middleware/dynamodb.ts.template" />

`DynamoDBClient`ã‚’ä½œæˆã—ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã«æ³¨å…¥ã™ã‚‹ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã§ã™ã€‚
  </TabItem>
  <TabItem label="middleware/index.ts">
<E2EDiff lang="typescript" before="dungeon-adventure/2/middleware/index.ts.old.template" after="dungeon-adventure/2/middleware/index.ts.template" />

`IMiddlewareContext`ã‚’æ‹¡å¼µã—ã¦`IDynamoDBContext`ã‚’è¿½åŠ ã—ã¾ã™ã€‚
  </TabItem>
  <TabItem label="init.ts">
<E2EDiff lang="typescript" before="dungeon-adventure/2/init.ts.old.template" after="dungeon-adventure/2/init.ts.template" />

DynamoDBãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’çµ„ã¿è¾¼ã¿ã¾ã™ã€‚

<Aside>
`concat` APIã¯å®šç¾©ã—ãŸãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ã«ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã‚’ãƒã‚¤ãƒ³ãƒ‰ã—ã¾ã™ã€‚è©³ç´°ã¯[concatã‚¬ã‚¤ãƒ‰](https://trpc.io/docs/server/middlewares#concat)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚
</Aside>
  </TabItem>
</Tabs>

### ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ã®å®šç¾©

APIãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè£…ã—ã¾ã™ã€‚`packages/game-api/backend/src/procedures`å†…ã§ä»¥ä¸‹ã®å¤‰æ›´ã‚’åŠ ãˆã¾ã™:

<Tabs>
  <TabItem label="query-actions.ts">
<E2ECode lang="typescript" path="dungeon-adventure/2/procedures/query-actions.ts.template" />
  </TabItem>
  <TabItem label="query-games.ts">
<E2ECode lang="typescript" path="dungeon-adventure/2/procedures/query-games.ts.template" />
  </TabItem>
  <TabItem label="save-action.ts">
<E2ECode lang="typescript" path="dungeon-adventure/2/procedures/save-action.ts.template" />
  </TabItem>
  <TabItem label="save-game.ts">
<E2ECode lang="typescript" path="dungeon-adventure/2/procedures/save-game.ts.template" />
  </TabItem>
</Tabs>

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ä½¿ç”¨ã—ãªã„ãŸã‚ã€`echo.ts`ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ`packages/game-api/backend/src/procedures`å†…ï¼‰ã¯å‰Šé™¤ã§ãã¾ã™ã€‚

### ãƒ«ãƒ¼ã‚¿ãƒ¼è¨­å®š

ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ã‚’APIã«æ¥ç¶šã—ã¾ã™ã€‚ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ›´æ–°ã—ã¾ã™:

<E2EDiff lang="typescript" before="dungeon-adventure/2/router.ts.old.template" after="dungeon-adventure/2/router.ts.template" />

### ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£

æœ€å¾Œã«DynamoDBãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆã—ã€Game APIã‹ã‚‰æ“ä½œæ¨©é™ã‚’ä»˜ä¸ã™ã‚‹ãŸã‚ã‚¤ãƒ³ãƒ•ãƒ©ã‚’æ›´æ–°ã—ã¾ã™ã€‚`packages/infra/src`ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«æ›´æ–°ã—ã¾ã™:

<Tabs>
  <TabItem label="constructs/electrodb-table.ts">
<E2ECode lang="typescript" path="dungeon-adventure/2/constructs/electrodb-table.ts.template" />
  </TabItem>
  <TabItem label="stacks/application-stack.ts">
<E2EDiff lang="typescript" before="dungeon-adventure/1/application-stack.ts.template" after="dungeon-adventure/2/stacks/application-stack.ts.template" />

:::note
å„ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ã¯å€‹åˆ¥ã®Lambdaé–¢æ•°ã§æä¾›ã•ã‚Œã‚‹ãŸã‚ã€æœ€å°æ¨©é™ã®åŸå‰‡ã«å¾“ã„ã€ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ã®å®Ÿè£…ã«åŸºã¥ã„ã¦å¿…è¦ãªèª­ã¿æ›¸ãæ¨©é™ã®ã¿ã‚’å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¾ã™ã€‚
:::
  </TabItem>
</Tabs>

### ãƒ‡ãƒ—ãƒ­ã‚¤ã¨ãƒ†ã‚¹ãƒˆ

ã¾ãšã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã‚’ãƒ“ãƒ«ãƒ‰ã—ã¾ã™:

<NxCommands commands={['run-many --target build --all']} />

<Aside type="tip">
ãƒªãƒ³ã‚¿ãƒ¼ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§è‡ªå‹•ä¿®æ­£ã§ãã¾ã™ã€‚

<NxCommands commands={['run-many --target lint --configuration=fix --all']} />
</Aside>

æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã§ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã§ãã¾ã™:

<NxCommands commands={['run @dungeon-adventure/infra:deploy dungeon-adventure-infra-sandbox']} />

åˆå›ãƒ‡ãƒ—ãƒ­ã‚¤ã¯ç´„8åˆ†ã‹ã‹ã‚Šã¾ã™ã€‚ä»¥é™ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã¯ç´„2åˆ†ã§ã™ã€‚

:::tip
Lambdaé–¢æ•°ã®ã‚³ãƒ¼ãƒ‰å¤‰æ›´ã‚’åå¾©ã™ã‚‹å ´åˆã€ã‚³ãƒ¼ãƒ‰ãƒ“ãƒ«ãƒ‰å¾Œã«`--hotswap`ãƒ•ãƒ©ã‚°ã‚’ä»˜ã‘ã¦ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã¨ã€å¤§å¹…ã«çŸ­ã„ï¼ˆ2-3ç§’ï¼‰ãƒ‡ãƒ—ãƒ­ã‚¤æ™‚é–“ã«ãªã‚Šã¾ã™ã€‚

<NxCommands commands={['run @dungeon-adventure/infra:deploy dungeon-adventure-infra-sandbox --hotswap']} />
:::

<Drawer title="ãƒ‡ãƒ—ãƒ­ã‚¤ã‚³ãƒãƒ³ãƒ‰" trigger="å…¨ã‚¹ã‚¿ãƒƒã‚¯ã‚’ä¸€æ‹¬ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹æ–¹æ³•ã¯ã“ã¡ã‚‰">

CDKã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å†…ã®å…¨ã‚¹ã‚¿ãƒƒã‚¯ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã«ã¯:

<NxCommands commands={['run @dungeon-adventure/infra:deploy --all']} />

ãŸã ã—ã€æœ¬ç•ªç’°å¢ƒç”¨ã‚¹ã‚¿ãƒƒã‚¯ã‚’`infra-prod`ãªã©ã§åˆ†é›¢ã™ã‚‹å ´åˆã€`--all`ãƒ•ãƒ©ã‚°ã¯æ„å›³ã—ãªã„ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’å¼•ãèµ·ã“ã™å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚**æ¨å¥¨ã—ã¾ã›ã‚“**ï¼

</Drawer>

ãƒ‡ãƒ—ãƒ­ã‚¤å®Œäº†å¾Œã€ä»¥ä¸‹ã®ã‚ˆã†ãªå‡ºåŠ›ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ï¼ˆä¸€éƒ¨å€¤ã¯ç·¨é›†æ¸ˆã¿ï¼‰:

```bash
dungeon-adventure-infra-sandbox
dungeon-adventure-infra-sandbox: deploying... [2/2]

 âœ…  dungeon-adventure-infra-sandbox

âœ¨  Deployment time: 354s

Outputs:
dungeon-adventure-infra-sandbox.ElectroDbTableTableNameXXX = dungeon-adventure-infra-sandbox-ElectroDbTableXXX-YYY
dungeon-adventure-infra-sandbox.GameApiEndpointXXX = https://xxx.execute-api.region.amazonaws.com/prod/
dungeon-adventure-infra-sandbox.GameUIDistributionDomainNameXXX = xxx.cloudfront.net
dungeon-adventure-infra-sandbox.StoryApiEndpointXXX = https://xxx.execute-api.region.amazonaws.com/prod/
dungeon-adventure-infra-sandbox.UserIdentityUserIdentityIdentityPoolIdXXX = region:xxx
dungeon-adventure-infra-sandbox.UserIdentityUserIdentityUserPoolIdXXX = region_xxx
```

APIã¯ä»¥ä¸‹ã®æ–¹æ³•ã§ãƒ†ã‚¹ãƒˆã§ãã¾ã™:
<ul>
<li>tRPCãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ãƒ­ãƒ¼ã‚«ãƒ«ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’èµ·å‹•ã—ã€`curl`ã§APIã‚’å‘¼ã³å‡ºã™</li>
<li>
<Drawer title="Sigv4å¯¾å¿œcurl" trigger="ãƒ‡ãƒ—ãƒ­ã‚¤æ¸ˆã¿APIã‚’sigv4å¯¾å¿œcurlã§å‘¼ã³å‡ºã™">

<Tabs>
  <TabItem label="Bash/Linux/macOS">
`.bashrc`ãƒ•ã‚¡ã‚¤ãƒ«ã«ä»¥ä¸‹ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’è¿½åŠ ï¼ˆ`source`ã§åæ˜ ï¼‰ã™ã‚‹ã‹ã€ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œå‰ã«ç›´æ¥è²¼ã‚Šä»˜ã‘ã¾ã™ã€‚
```bash
// ~/.bashrc
acurl () {
    REGION=$1
    SERVICE=$2
    shift; shift;
    curl --aws-sigv4 "aws:amz:$REGION:$SERVICE" --user "$(aws configure get aws_access_key_id):$(aws configure get aws_secret_access_key)" -H "X-Amz-Security-Token: $(aws configure get aws_session_token)" "$@"
}
```

sigv4èªè¨¼æ¸ˆã¿curlãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å®Ÿè¡Œä¾‹:

###### API Gateway
```bash
acurl ap-southeast-2 execute-api -X GET https://xxx
```

###### ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°Lambdaé–¢æ•°URL
```bash
acurl ap-southeast-2 lambda -N -X POST https://xxx
```
  </TabItem>
  <TabItem label="Windows PowerShell">
PowerShellãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã«é–¢æ•°ã‚’è¿½åŠ ã™ã‚‹ã‹ã€ç¾åœ¨ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã«ç›´æ¥è²¼ã‚Šä»˜ã‘ã¾ã™ã€‚
```powershell
function acurl {
    param(
        [Parameter(Mandatory=$true)][string]$Region,
        [Parameter(Mandatory=$true)][string]$Service,
        [Parameter(ValueFromRemainingArguments=$true)][string[]]$CurlArgs
    )
    
    $AccessKey = aws configure get aws_access_key_id
    $SecretKey = aws configure get aws_secret_access_key
    $SessionToken = aws configure get aws_session_token
    
    & curl --aws-sigv4 "aws:amz:$Region`:$Service" --user "$AccessKey`:$SecretKey" -H "X-Amz-Security-Token: $SessionToken" @CurlArgs
}
```

sigv4èªè¨¼æ¸ˆã¿curlãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å®Ÿè¡Œä¾‹:

###### API Gateway
```powershell
acurl ap-southeast-2 execute-api -X GET https://xxx
```

###### ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°Lambdaé–¢æ•°URL
```powershell
acurl ap-southeast-2 lambda -N -X POST https://xxx
```
  </TabItem>
</Tabs>

</Drawer>
</li>
</ul>


<Tabs>
  <TabItem label="ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒ">
    æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã§`game-api`ã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•:

    <NxCommands highlights={['dungeon-adventure-infra-sandbox-ElectroDbTableXXX-YYY']} env={{TABLE_NAME:"dungeon-adventure-infra-sandbox-ElectroDbTableXXX-YYY"}} commands={["run @dungeon-adventure/game-api:serve"]} />

    <Aside type="caution">
    ãƒã‚¤ãƒ©ã‚¤ãƒˆã•ã‚ŒãŸãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã¯ã€CDKãƒ‡ãƒ—ãƒ­ã‚¤å‡ºåŠ›ã®`dungeon-adventure-infra-sandbox.ElectroDbTableTableNameXXX`å€¤ã§ç½®ãæ›ãˆã¦ãã ã•ã„ã€‚
    </Aside>

    ã‚µãƒ¼ãƒãƒ¼èµ·å‹•å¾Œã€æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã§å‘¼ã³å‡ºã›ã¾ã™:

    ```bash
    curl -X GET 'http://localhost:2022/games.query?input=%7B%7D'
    ```
  </TabItem>
  <TabItem label="ãƒ‡ãƒ—ãƒ­ã‚¤ç’°å¢ƒ">
```bash "https://xxx.execute-api.ap-southeast-2.amazonaws.com/prod/" "ap-southeast-2"
acurl ap-southeast-2 execute-api -X GET 'https://xxx.execute-api.ap-southeast-2.amazonaws.com/prod/games.query?input=%7B%7D'
```
    <Aside type="caution">
    ãƒã‚¤ãƒ©ã‚¤ãƒˆã•ã‚ŒãŸãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã¯CDKãƒ‡ãƒ—ãƒ­ã‚¤å‡ºåŠ›ã®`dungeon-adventure-infra-sandbox.GameApiGameApiEndpointXXX`å€¤ã§ç½®ãæ›ãˆã€ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã‚’é©åˆ‡ã«è¨­å®šã—ã¦ãã ã•ã„ã€‚
    </Aside>
  </TabItem>
</Tabs>

:::note
APIãƒ†ã‚¹ãƒˆã§æ¸¡ã™`%7B%7D`ã¯URIã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã•ã‚ŒãŸç©ºã®JSONã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼ˆ`{}`ï¼‰ã§ã™ã€‚
:::

ã‚³ãƒãƒ³ãƒ‰ãŒæˆåŠŸã™ã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒè¿”ã‚Šã¾ã™:

```json
{"result":{"data":{"items":[],"cursor":null}}}
```

ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼tRPCã‚’ä½¿ç”¨ã—ãŸæœ€åˆã®APIã®æ§‹ç¯‰ã¨ãƒ‡ãƒ—ãƒ­ã‚¤ã«æˆåŠŸã—ã¾ã—ãŸï¼ ğŸ‰ğŸ‰ğŸ‰